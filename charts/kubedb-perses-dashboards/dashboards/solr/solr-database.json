{{- $shared := and (eq .Values.app.name "") (eq .Values.app.namespace "") -}}
{{- $alerts := (eq $.Values.dashboard.alerts true) -}}
{
  "kind": "Dashboard",
  "metadata": {
    "name": "Vm64KR1Sz",
    "createdAt": "0001-01-01T00:00:00Z",
    "updatedAt": "0001-01-01T00:00:00Z",
    "version": 0,
    "project": "pp"
  },
  "spec": {
    "display": {
      "name": "KubeDB / Solr / Database"
    },
    "variables": [
      {
        "kind": "ListVariable",
        "spec": {
          "display": {
            "hidden": false
          },
          "defaultValue": "Prometheus",
          "allowAllValue": false,
          "allowMultiple": false,
          "plugin": {
            "kind": "DatasourceVariable",
            "spec": {
              "datasourcePluginKind": "PrometheusDatasource"
            }
          },
          "name": "datasource"
        }
      },
      {
        "kind": "ListVariable",
        "spec": {
          "display": {
            "hidden": false
          },
          "defaultValue": "demo",
          "allowAllValue": false,
          "allowMultiple": false,
          "sort": "none",
          "plugin": {
            "kind": "PrometheusLabelValuesVariable",
            "spec": {
              "labelName": "namespace",
              "matchers": [
                "kube_namespace_created"
              ]
            }
          },
          "name": "namespace"
        }
      },
      {
        "kind": "ListVariable",
        "spec": {
          "display": {
            "hidden": false
          },
          "defaultValue": "solr-cluster",
          "allowAllValue": false,
          "allowMultiple": false,
          "sort": "alphabetical-asc",
          "plugin": {
            "kind": "PrometheusLabelValuesVariable",
            "spec": {
              "labelName": "app",
              "matchers": [
                "kubedb_com_solr_status_phase{namespace=~\"$namespace\"}"
              ]
            }
          },
          "name": "app"
        }
      },
      {
        "kind": "ListVariable",
        "spec": {
          "display": {
            "hidden": true
          },
          "defaultValue": [
            "$__all"
          ],
          "allowAllValue": true,
          "allowMultiple": true,
          "sort": "alphabetical-asc",
          "plugin": {
            "kind": "PrometheusLabelValuesVariable",
            "spec": {
              "labelName": "zk_host",
              "matchers": [
                "solr_ping{namespace=~\"$namespace\",service=~\"$app-stats\",zk_host=~\".+\"}"
              ]
            }
          },
          "name": "zk_host"
        }
      },
      {
        "kind": "ListVariable",
        "spec": {
          "display": {
            "hidden": true
          },
          "defaultValue": [
            "$__all"
          ],
          "allowAllValue": true,
          "allowMultiple": true,
          "sort": "alphabetical-asc",
          "plugin": {
            "kind": "PrometheusLabelValuesVariable",
            "spec": {
              "labelName": "base_url",
              "matchers": [
                "solr_ping{namespace=~\"$namespace\",service=~\"$app-stats\",base_url=~\".+\"}"
              ]
            }
          },
          "name": "base_url"
        }
      }
    ],
    "panels": {
      "0_0": {
        "kind": "Panel",
        "spec": {
          "display": {
            "name": "Number of total nodes",
            "description": "Total nodes in the cluster"
          },
          "plugin": {
            "kind": "StatChart",
            "spec": {
              "calculation": "last-number",
              "thresholds": {
                "steps": [
                  {
                    "color": "#73bf69",
                    "value": 0
                  },
                  {
                    "color": "#f2495c",
                    "value": 80
                  }
                ]
              }
            }
          },
          "queries": [
            {
              "kind": "TimeSeriesQuery",
              "spec": {
                "plugin": {
                  "kind": "PrometheusTimeSeriesQuery",
                  "spec": {
                    "minStep": "",
                    "query": "max by (core) (count(count by (node_name) (solr_collections_replica_state{namespace=~\"$namespace\",service=~\"$app-stats\"})) < solr_collections_live_nodes{namespace=~\"$namespace\",service=~\"$app-stats\"} or solr_collections_live_nodes{namespace=~\"$namespace\",service=~\"$app-stats\"})",
                    "seriesNameFormat": "Total Nodes"
                  }
                }
              }
            }
          ]
        }
      },
      "0_1": {
        "kind": "Panel",
        "spec": {
          "display": {
            "name": "Live nodes",
            "description": "Total number of live nodes"
          },
          "plugin": {
            "kind": "StatChart",
            "spec": {
              "calculation": "last-number",
              "thresholds": {
                "steps": [
                  {
                    "color": "#73bf69",
                    "value": 0
                  },
                  {
                    "color": "#f2495c",
                    "value": 80
                  }
                ]
              }
            }
          },
          "queries": [
            {
              "kind": "TimeSeriesQuery",
              "spec": {
                "plugin": {
                  "kind": "PrometheusTimeSeriesQuery",
                  "spec": {
                    "minStep": "",
                    "query": "max by (core) (count(count by (node_name) (solr_collections_replica_state{namespace=~\"$namespace\",service=~\"$app-stats\"})) < solr_collections_live_nodes{namespace=~\"$namespace\",service=~\"$app-stats\"} or solr_collections_live_nodes{namespace=~\"$namespace\",service=~\"$app-stats\"})",
                    "seriesNameFormat": ""
                  }
                }
              }
            }
          ]
        }
      },
      "0_10": {
        "kind": "Panel",
        "spec": {
          "display": {
            "name": "Zookeeper ensemble size",
            "description": "Size of zookeeper ensemble"
          },
          "plugin": {
            "kind": "StatChart",
            "spec": {
              "calculation": "last-number",
              "thresholds": {
                "steps": [
                  {
                    "color": "#73bf69",
                    "value": 0
                  },
                  {
                    "color": "#f2495c",
                    "value": 80
                  }
                ]
              }
            }
          },
          "queries": [
            {
              "kind": "TimeSeriesQuery",
              "spec": {
                "plugin": {
                  "kind": "PrometheusTimeSeriesQuery",
                  "spec": {
                    "minStep": "",
                    "query": "max by (zk_host) (solr_zookeeper_ensemble_size{namespace=~\"$namespace\",service=~\"$app-stats\"})",
                    "seriesNameFormat": "Ensemble size"
                  }
                }
              }
            }
          ]
        }
      },
      "0_11": {
        "kind": "Panel",
        "spec": {
          "display": {
            "name": "Replica state history",
            "description": "Current state of replicas. We are showing down replica here."
          },
          "plugin": {
            "kind": "TimeSeriesChart",
            "spec": {}
          },
          "queries": [
            {
              "kind": "TimeSeriesQuery",
              "spec": {
                "plugin": {
                  "kind": "PrometheusTimeSeriesQuery",
                  "spec": {
                    "minStep": "",
                    "query": "1 - max by (core, state) (solr_collections_replica_state{namespace=~\"$namespace\",service=~\"$app-stats\",base_url=~\"$base_url\",})",
                    "seriesNameFormat": ""
                  }
                }
              }
            }
          ]
        }
      },
      "0_2": {
        "kind": "Panel",
        "spec": {
          "display": {
            "name": "Shard leaders",
            "description": "All shard leaders."
          },
          "plugin": {
            "kind": "TimeSeriesChart",
            "spec": {}
          },
          "queries": [
            {
              "kind": "TimeSeriesQuery",
              "spec": {
                "plugin": {
                  "kind": "PrometheusTimeSeriesQuery",
                  "spec": {
                    "minStep": "",
                    "query": "max by (core,replica, shard, collection) (solr_collections_shard_leader{namespace=~\"$namespace\",service=~\"$app-stats\"})",
                    "seriesNameFormat": ""
                  }
                }
              }
            }
          ]
        }
      },
      "0_3": {
        "kind": "Panel",
        "spec": {
          "display": {
            "name": "Number of Collections",
            "description": "Total number of collections"
          },
          "plugin": {
            "kind": "StatChart",
            "spec": {
              "calculation": "last-number",
              "thresholds": {
                "steps": [
                  {
                    "color": "#73bf69",
                    "value": 0
                  },
                  {
                    "color": "#f2495c",
                    "value": 80
                  }
                ]
              }
            }
          },
          "queries": [
            {
              "kind": "TimeSeriesQuery",
              "spec": {
                "plugin": {
                  "kind": "PrometheusTimeSeriesQuery",
                  "spec": {
                    "minStep": "",
                    "query": "count(count by (collection)  (solr_collections_replica_state{namespace=~\"$namespace\",service=~\"$app-stats\"}))",
                    "seriesNameFormat": ""
                  }
                }
              }
            }
          ]
        }
      },
      "0_4": {
        "kind": "Panel",
        "spec": {
          "display": {
            "name": "Total Replicas",
            "description": "Total number of replicas."
          },
          "plugin": {
            "kind": "StatChart",
            "spec": {
              "calculation": "last-number",
              "thresholds": {
                "steps": [
                  {
                    "color": "#73bf69",
                    "value": 0
                  },
                  {
                    "color": "#f2495c",
                    "value": 80
                  }
                ]
              }
            }
          },
          "queries": [
            {
              "kind": "TimeSeriesQuery",
              "spec": {
                "plugin": {
                  "kind": "PrometheusTimeSeriesQuery",
                  "spec": {
                    "minStep": "",
                    "query": "count(max by (core) (solr_collections_replica_state{namespace=~\"$namespace\",service=~\"$app-stats\",base_url=~\"$base_url\"}))",
                    "seriesNameFormat": ""
                  }
                }
              }
            }
          ]
        }
      },
      "0_5": {
        "kind": "Panel",
        "spec": {
          "display": {
            "name": "Active Replicas",
            "description": "Total number of active replicas"
          },
          "plugin": {
            "kind": "StatChart",
            "spec": {
              "calculation": "last-number",
              "thresholds": {
                "steps": [
                  {
                    "color": "#73bf69",
                    "value": 0
                  },
                  {
                    "color": "#f2495c",
                    "value": 80
                  }
                ]
              }
            }
          },
          "queries": [
            {
              "kind": "TimeSeriesQuery",
              "spec": {
                "plugin": {
                  "kind": "PrometheusTimeSeriesQuery",
                  "spec": {
                    "minStep": "",
                    "query": "count(max by (core) (solr_collections_replica_state{namespace=~\"$namespace\",service=~\"$app-stats\",base_url=~\"$base_url\",state=\"active\"})) OR on() vector(0)",
                    "seriesNameFormat": "Active"
                  }
                }
              }
            }
          ]
        }
      },
      "0_6": {
        "kind": "Panel",
        "spec": {
          "display": {
            "name": "Down Replicas",
            "description": "Number of down replicas"
          },
          "plugin": {
            "kind": "StatChart",
            "spec": {
              "calculation": "last-number",
              "thresholds": {
                "steps": [
                  {
                    "color": "#73bf69",
                    "value": 0
                  },
                  {
                    "color": "#f2495c",
                    "value": 80
                  }
                ]
              }
            }
          },
          "queries": [
            {
              "kind": "TimeSeriesQuery",
              "spec": {
                "plugin": {
                  "kind": "PrometheusTimeSeriesQuery",
                  "spec": {
                    "minStep": "",
                    "query": "count(max by (core) (solr_collections_replica_state{namespace=~\"$namespace\",service=~\"$app-stats\",base_url=~\"$base_url\",state=\"down\"})) OR on() vector(0)",
                    "seriesNameFormat": "Down"
                  }
                }
              }
            }
          ]
        }
      },
      "0_7": {
        "kind": "Panel",
        "spec": {
          "display": {
            "name": "Recovering replicas",
            "description": "Total number of recovering replicas"
          },
          "plugin": {
            "kind": "StatChart",
            "spec": {
              "calculation": "last-number",
              "thresholds": {
                "steps": [
                  {
                    "color": "#73bf69",
                    "value": 0
                  },
                  {
                    "color": "#f2495c",
                    "value": 80
                  }
                ]
              }
            }
          },
          "queries": [
            {
              "kind": "TimeSeriesQuery",
              "spec": {
                "plugin": {
                  "kind": "PrometheusTimeSeriesQuery",
                  "spec": {
                    "minStep": "",
                    "query": "count(max by (core) (solr_collections_replica_state{namespace=~\"$namespace\",service=~\"$app-stats\",base_url=~\"$base_url\",state=\"recovering\"})) OR on() vector(0)",
                    "seriesNameFormat": "Recovering"
                  }
                }
              }
            }
          ]
        }
      },
      "0_8": {
        "kind": "Panel",
        "spec": {
          "display": {
            "name": "Recovery failed replicas",
            "description": "Total number of replicas failed to recover"
          },
          "plugin": {
            "kind": "StatChart",
            "spec": {
              "calculation": "last-number",
              "thresholds": {
                "steps": [
                  {
                    "color": "#73bf69",
                    "value": 0
                  },
                  {
                    "color": "#f2495c",
                    "value": 80
                  }
                ]
              }
            }
          },
          "queries": [
            {
              "kind": "TimeSeriesQuery",
              "spec": {
                "plugin": {
                  "kind": "PrometheusTimeSeriesQuery",
                  "spec": {
                    "minStep": "",
                    "query": "count(max by (core) (solr_collections_replica_state{namespace=~\"$namespace\",service=~\"$app-stats\",base_url=~\"$base_url\",state=\"recovery_failed\"})) OR on() vector(0)",
                    "seriesNameFormat": ""
                  }
                }
              }
            }
          ]
        }
      },
      "0_9": {
        "kind": "Panel",
        "spec": {
          "display": {
            "name": "Zookeeper Healthy Nodes",
            "description": "Total number of zookeeper healthy nodes."
          },
          "plugin": {
            "kind": "StatChart",
            "spec": {
              "calculation": "last-number",
              "thresholds": {
                "steps": [
                  {
                    "color": "#73bf69",
                    "value": 0
                  },
                  {
                    "color": "#f2495c",
                    "value": 80
                  }
                ]
              }
            }
          },
          "queries": [
            {
              "kind": "TimeSeriesQuery",
              "spec": {
                "plugin": {
                  "kind": "PrometheusTimeSeriesQuery",
                  "spec": {
                    "minStep": "",
                    "query": "(count(max by (host) (solr_zookeeper_nodestatus{namespace=~\"$namespace\",service=~\"$app-stats\"}) == 1))",
                    "seriesNameFormat": "Healthy Nodes"
                  }
                }
              }
            }
          ]
        }
      },
      "1_0": {
        "kind": "Panel",
        "spec": {
          "display": {
            "name": "Total QPS (by collection)",
            "description": "Distributed QPS 1-min rate  aggregated by collection, roughly the current QPS across all nodes per "
          },
          "plugin": {
            "kind": "TimeSeriesChart",
            "spec": {}
          },
          "queries": [
            {
              "kind": "TimeSeriesQuery",
              "spec": {
                "plugin": {
                  "kind": "PrometheusTimeSeriesQuery",
                  "spec": {
                    "minStep": "",
                    "query": "sum by (collection) (solr_metrics_core_query_1minRate{namespace=~\"$namespace\",service=~\"$app-stats\"})",
                    "seriesNameFormat": ""
                  }
                }
              }
            }
          ]
        }
      },
      "1_1": {
        "kind": "Panel",
        "spec": {
          "display": {
            "name": "Total QPS (by node)",
            "description": "Distributed QPS 1-min rate aggregated by base_url (Solr node)"
          },
          "plugin": {
            "kind": "TimeSeriesChart",
            "spec": {}
          },
          "queries": [
            {
              "kind": "TimeSeriesQuery",
              "spec": {
                "plugin": {
                  "kind": "PrometheusTimeSeriesQuery",
                  "spec": {
                    "minStep": "",
                    "query": "sum by (collection) (solr_metrics_core_query_1minRate{namespace=~\"$namespace\",service=~\"$app-stats\"})",
                    "seriesNameFormat": ""
                  }
                }
              }
            }
          ]
        }
      },
      "2_0": {
        "kind": "Panel",
        "spec": {
          "display": {
            "name": "Buffers",
            "description": "Total number of jvm buffers"
          },
          "plugin": {
            "kind": "TimeSeriesChart",
            "spec": {}
          },
          "queries": [
            {
              "kind": "TimeSeriesQuery",
              "spec": {
                "plugin": {
                  "kind": "PrometheusTimeSeriesQuery",
                  "spec": {
                    "minStep": "",
                    "query": "solr_metrics_jvm_buffers{namespace=~\"$namespace\",service=~\"$app-stats\",base_url=~\"$base_url\"}",
                    "seriesNameFormat": ""
                  }
                }
              }
            }
          ]
        }
      },
      "2_1": {
        "kind": "Panel",
        "spec": {
          "display": {
            "name": "Buffer Size",
            "description": "Size of buffer in bytes"
          },
          "plugin": {
            "kind": "TimeSeriesChart",
            "spec": {}
          },
          "queries": [
            {
              "kind": "TimeSeriesQuery",
              "spec": {
                "plugin": {
                  "kind": "PrometheusTimeSeriesQuery",
                  "spec": {
                    "minStep": "",
                    "query": "solr_metrics_jvm_buffers_bytes{namespace=~\"$namespace\",service=~\"$app-stats\",base_url=~\"$base_url\"}",
                    "seriesNameFormat": ""
                  }
                }
              }
            }
          ]
        }
      },
      "2_2": {
        "kind": "Panel",
        "spec": {
          "display": {
            "name": "GC Count",
            "description": "Total number of garbage collection"
          },
          "plugin": {
            "kind": "TimeSeriesChart",
            "spec": {}
          },
          "queries": [
            {
              "kind": "TimeSeriesQuery",
              "spec": {
                "plugin": {
                  "kind": "PrometheusTimeSeriesQuery",
                  "spec": {
                    "minStep": "",
                    "query": "increase(solr_metrics_jvm_gc_total{namespace=~\"$namespace\",service=~\"$app-stats\",base_url=~\"$base_url\"}[1m])",
                    "seriesNameFormat": ""
                  }
                }
              }
            }
          ]
        }
      },
      "2_3": {
        "kind": "Panel",
        "spec": {
          "display": {
            "name": "GC Time Seconds",
            "description": "Total time of garbage collection"
          },
          "plugin": {
            "kind": "TimeSeriesChart",
            "spec": {}
          },
          "queries": [
            {
              "kind": "TimeSeriesQuery",
              "spec": {
                "plugin": {
                  "kind": "PrometheusTimeSeriesQuery",
                  "spec": {
                    "minStep": "",
                    "query": "increase(solr_metrics_jvm_gc_seconds_total{namespace=~\"$namespace\",service=~\"$app-stats\",base_url=~\"$base_url\"}[1m])",
                    "seriesNameFormat": ""
                  }
                }
              }
            }
          ]
        }
      },
      "2_4": {
        "kind": "Panel",
        "spec": {
          "display": {
            "name": "Heap Size",
            "description": "Total heap size in bytes"
          },
          "plugin": {
            "kind": "TimeSeriesChart",
            "spec": {}
          },
          "queries": [
            {
              "kind": "TimeSeriesQuery",
              "spec": {
                "plugin": {
                  "kind": "PrometheusTimeSeriesQuery",
                  "spec": {
                    "minStep": "",
                    "query": "solr_metrics_jvm_memory_heap_bytes{namespace=~\"$namespace\",service=~\"$app-stats\",base_url=~\"$base_url\"}",
                    "seriesNameFormat": ""
                  }
                }
              }
            }
          ]
        }
      },
      "2_5": {
        "kind": "Panel",
        "spec": {
          "display": {
            "name": "Non-heap size",
            "description": "Size of non heap memory"
          },
          "plugin": {
            "kind": "TimeSeriesChart",
            "spec": {}
          },
          "queries": [
            {
              "kind": "TimeSeriesQuery",
              "spec": {
                "plugin": {
                  "kind": "PrometheusTimeSeriesQuery",
                  "spec": {
                    "minStep": "",
                    "query": "solr_metrics_jvm_memory_non_heap_bytes{namespace=~\"$namespace\",service=~\"$app-stats\",base_url=~\"$base_url\"}",
                    "seriesNameFormat": ""
                  }
                }
              }
            }
          ]
        }
      },
      "2_6": {
        "kind": "Panel",
        "spec": {
          "display": {
            "name": "Pool size",
            "description": "Pool size in bytes"
          },
          "plugin": {
            "kind": "TimeSeriesChart",
            "spec": {}
          },
          "queries": [
            {
              "kind": "TimeSeriesQuery",
              "spec": {
                "plugin": {
                  "kind": "PrometheusTimeSeriesQuery",
                  "spec": {
                    "minStep": "",
                    "query": "solr_metrics_jvm_memory_pools_bytes{namespace=~\"$namespace\",service=~\"$app-stats\",base_url=~\"$base_url\"}",
                    "seriesNameFormat": ""
                  }
                }
              }
            }
          ]
        }
      },
      "2_7": {
        "kind": "Panel",
        "spec": {
          "display": {
            "name": "Memory size",
            "description": "Memory size in bytes"
          },
          "plugin": {
            "kind": "TimeSeriesChart",
            "spec": {}
          },
          "queries": [
            {
              "kind": "TimeSeriesQuery",
              "spec": {
                "plugin": {
                  "kind": "PrometheusTimeSeriesQuery",
                  "spec": {
                    "minStep": "",
                    "query": "solr_metrics_jvm_memory_bytes{namespace=~\"$namespace\",service=~\"$app-stats\",base_url=~\"$base_url\"}",
                    "seriesNameFormat": ""
                  }
                }
              }
            }
          ]
        }
      },
      "2_8": {
        "kind": "Panel",
        "spec": {
          "display": {
            "name": "Thread size",
            "description": "Total thread size"
          },
          "plugin": {
            "kind": "TimeSeriesChart",
            "spec": {}
          },
          "queries": [
            {
              "kind": "TimeSeriesQuery",
              "spec": {
                "plugin": {
                  "kind": "PrometheusTimeSeriesQuery",
                  "spec": {
                    "minStep": "",
                    "query": "solr_metrics_jvm_threads{namespace=~\"$namespace\",service=~\"$app-stats\",base_url=~\"$base_url\"}",
                    "seriesNameFormat": ""
                  }
                }
              }
            }
          ]
        }
      },
      "3_0": {
        "kind": "Panel",
        "spec": {
          "display": {
            "name": "Request",
            "description": "Total number of requests"
          },
          "plugin": {
            "kind": "TimeSeriesChart",
            "spec": {}
          },
          "queries": [
            {
              "kind": "TimeSeriesQuery",
              "spec": {
                "plugin": {
                  "kind": "PrometheusTimeSeriesQuery",
                  "spec": {
                    "minStep": "",
                    "query": "solr_metrics_node_requests_total{namespace=~\"$namespace\",service=~\"$app-stats\",base_url=~\"$base_url\"}",
                    "seriesNameFormat": ""
                  }
                }
              }
            }
          ]
        }
      },
      "3_1": {
        "kind": "Panel",
        "spec": {
          "display": {
            "name": "Request time",
            "description": "Total request time in seconds"
          },
          "plugin": {
            "kind": "TimeSeriesChart",
            "spec": {}
          },
          "queries": [
            {
              "kind": "TimeSeriesQuery",
              "spec": {
                "plugin": {
                  "kind": "PrometheusTimeSeriesQuery",
                  "spec": {
                    "minStep": "",
                    "query": "increase(solr_metrics_node_time_seconds_total{namespace=~\"$namespace\",service=~\"$app-stats\",base_url=~\"$base_url\"}[1m])",
                    "seriesNameFormat": ""
                  }
                }
              }
            }
          ]
        }
      },
      "3_10": {
        "kind": "Panel",
        "spec": {
          "display": {
            "name": "Thread pool running",
            "description": "Total number of node thread pool"
          },
          "plugin": {
            "kind": "TimeSeriesChart",
            "spec": {}
          },
          "queries": [
            {
              "kind": "TimeSeriesQuery",
              "spec": {
                "plugin": {
                  "kind": "PrometheusTimeSeriesQuery",
                  "spec": {
                    "minStep": "",
                    "query": "solr_metrics_node_thread_pool_running{namespace=~\"$namespace\",service=~\"$app-stats\",base_url=~\"$base_url\"}",
                    "seriesNameFormat": ""
                  }
                }
              }
            }
          ]
        }
      },
      "3_11": {
        "kind": "Panel",
        "spec": {
          "display": {
            "name": "Connections",
            "description": "Total number of node connections"
          },
          "plugin": {
            "kind": "TimeSeriesChart",
            "spec": {}
          },
          "queries": [
            {
              "kind": "TimeSeriesQuery",
              "spec": {
                "plugin": {
                  "kind": "PrometheusTimeSeriesQuery",
                  "spec": {
                    "minStep": "",
                    "query": "solr_metrics_node_connections{namespace=~\"$namespace\",service=~\"$app-stats\",base_url=~\"$base_url\"}",
                    "seriesNameFormat": ""
                  }
                }
              }
            }
          ]
        }
      },
      "3_12": {
        "kind": "Panel",
        "spec": {
          "display": {
            "name": "Leader Count(by node)",
            "description": "Total number of leaders by node."
          },
          "plugin": {
            "kind": "TimeSeriesChart",
            "spec": {}
          },
          "queries": [
            {
              "kind": "TimeSeriesQuery",
              "spec": {
                "plugin": {
                  "kind": "PrometheusTimeSeriesQuery",
                  "spec": {
                    "minStep": "",
                    "query": "sum by (base_url) (max by (core) (solr_collections_shard_leader{namespace=~\"$namespace\",service=~\"$app-stats\",base_url=~\"$base_url\"}))",
                    "seriesNameFormat": ""
                  }
                }
              }
            }
          ]
        }
      },
      "3_2": {
        "kind": "Panel",
        "spec": {
          "display": {
            "name": "Client Errors",
            "description": "Total number of node client errors"
          },
          "plugin": {
            "kind": "TimeSeriesChart",
            "spec": {}
          },
          "queries": [
            {
              "kind": "TimeSeriesQuery",
              "spec": {
                "plugin": {
                  "kind": "PrometheusTimeSeriesQuery",
                  "spec": {
                    "minStep": "",
                    "query": "increase(solr_metrics_node_client_errors_total{namespace=~\"$namespace\",service=~\"$app-stats\",base_url=~\"$base_url\"}[1m])",
                    "seriesNameFormat": ""
                  }
                }
              }
            }
          ]
        }
      },
      "3_3": {
        "kind": "Panel",
        "spec": {
          "display": {
            "name": "Server errors",
            "description": "Total number of client server errors"
          },
          "plugin": {
            "kind": "TimeSeriesChart",
            "spec": {}
          },
          "queries": [
            {
              "kind": "TimeSeriesQuery",
              "spec": {
                "plugin": {
                  "kind": "PrometheusTimeSeriesQuery",
                  "spec": {
                    "minStep": "",
                    "query": "increase(solr_metrics_node_server_errors_total{namespace=~\"$namespace\",service=~\"$app-stats\",base_url=~\"$base_url\"}[1m])",
                    "seriesNameFormat": ""
                  }
                }
              }
            }
          ]
        }
      },
      "3_4": {
        "kind": "Panel",
        "spec": {
          "display": {
            "name": "Errors",
            "description": "Total node errors"
          },
          "plugin": {
            "kind": "TimeSeriesChart",
            "spec": {}
          },
          "queries": [
            {
              "kind": "TimeSeriesQuery",
              "spec": {
                "plugin": {
                  "kind": "PrometheusTimeSeriesQuery",
                  "spec": {
                    "minStep": "",
                    "query": "increase(solr_metrics_node_errors_total{namespace=~\"$namespace\",service=~\"$app-stats\",base_url=~\"$base_url\"}[1m])",
                    "seriesNameFormat": ""
                  }
                }
              }
            }
          ]
        }
      },
      "3_5": {
        "kind": "Panel",
        "spec": {
          "display": {
            "name": "Timeout",
            "description": "Total node timeout"
          },
          "plugin": {
            "kind": "TimeSeriesChart",
            "spec": {}
          },
          "queries": [
            {
              "kind": "TimeSeriesQuery",
              "spec": {
                "plugin": {
                  "kind": "PrometheusTimeSeriesQuery",
                  "spec": {
                    "minStep": "",
                    "query": "increase(solr_metrics_node_timeouts_total{namespace=~\"$namespace\",service=~\"$app-stats\",base_url=~\"$base_url\"}[1m])",
                    "seriesNameFormat": ""
                  }
                }
              }
            }
          ]
        }
      },
      "3_6": {
        "kind": "Panel",
        "spec": {
          "display": {
            "name": "Cores",
            "description": "Total node cores."
          },
          "plugin": {
            "kind": "TimeSeriesChart",
            "spec": {}
          },
          "queries": [
            {
              "kind": "TimeSeriesQuery",
              "spec": {
                "plugin": {
                  "kind": "PrometheusTimeSeriesQuery",
                  "spec": {
                    "minStep": "",
                    "query": "solr_metrics_node_cores{namespace=~\"$namespace\",service=~\"$app-stats\",base_url=~\"$base_url\"}",
                    "seriesNameFormat": ""
                  }
                }
              }
            }
          ]
        }
      },
      "3_7": {
        "kind": "Panel",
        "spec": {
          "display": {
            "name": "Core Root File System",
            "description": "Total memory consumed by core root file system."
          },
          "plugin": {
            "kind": "TimeSeriesChart",
            "spec": {}
          },
          "queries": [
            {
              "kind": "TimeSeriesQuery",
              "spec": {
                "plugin": {
                  "kind": "PrometheusTimeSeriesQuery",
                  "spec": {
                    "minStep": "",
                    "query": "solr_metrics_node_core_root_fs_bytes{namespace=~\"$namespace\",service=~\"$app-stats\",base_url=~\"$base_url\"}",
                    "seriesNameFormat": ""
                  }
                }
              }
            }
          ]
        }
      },
      "3_8": {
        "kind": "Panel",
        "spec": {
          "display": {
            "name": "Thread pool completed",
            "description": "Total thread pool completed."
          },
          "plugin": {
            "kind": "TimeSeriesChart",
            "spec": {}
          },
          "queries": [
            {
              "kind": "TimeSeriesQuery",
              "spec": {
                "plugin": {
                  "kind": "PrometheusTimeSeriesQuery",
                  "spec": {
                    "minStep": "",
                    "query": "solr_metrics_node_thread_pool_completed_total{namespace=~\"$namespace\",service=~\"$app-stats\",base_url=~\"$base_url\"}",
                    "seriesNameFormat": ""
                  }
                }
              }
            }
          ]
        }
      },
      "3_9": {
        "kind": "Panel",
        "spec": {
          "display": {
            "name": "Thread pool submitted",
            "description": "Total thread pool submitted."
          },
          "plugin": {
            "kind": "TimeSeriesChart",
            "spec": {}
          },
          "queries": [
            {
              "kind": "TimeSeriesQuery",
              "spec": {
                "plugin": {
                  "kind": "PrometheusTimeSeriesQuery",
                  "spec": {
                    "minStep": "",
                    "query": "solr_metrics_node_thread_pool_submitted_total{namespace=~\"$namespace\",service=~\"$app-stats\",base_url=~\"$base_url\"}",
                    "seriesNameFormat": ""
                  }
                }
              }
            }
          ]
        }
      }
    },
    "layouts": [
      {
        "kind": "Grid",
        "spec": {
          "display": {
            "title": "Solr Cluster",
            "collapse": {
              "open": true
            }
          },
          "items": [
            {
              "x": 0,
              "y": 1,
              "width": 6,
              "height": 7,
              "content": {
                "$ref": "#/spec/panels/0_0"
              }
            },
            {
              "x": 6,
              "y": 1,
              "width": 6,
              "height": 7,
              "content": {
                "$ref": "#/spec/panels/0_1"
              }
            },
            {
              "x": 12,
              "y": 1,
              "width": 12,
              "height": 7,
              "content": {
                "$ref": "#/spec/panels/0_2"
              }
            },
            {
              "x": 0,
              "y": 8,
              "width": 4,
              "height": 4,
              "content": {
                "$ref": "#/spec/panels/0_3"
              }
            },
            {
              "x": 4,
              "y": 8,
              "width": 4,
              "height": 4,
              "content": {
                "$ref": "#/spec/panels/0_4"
              }
            },
            {
              "x": 8,
              "y": 8,
              "width": 4,
              "height": 4,
              "content": {
                "$ref": "#/spec/panels/0_5"
              }
            },
            {
              "x": 12,
              "y": 8,
              "width": 4,
              "height": 4,
              "content": {
                "$ref": "#/spec/panels/0_6"
              }
            },
            {
              "x": 16,
              "y": 8,
              "width": 4,
              "height": 4,
              "content": {
                "$ref": "#/spec/panels/0_7"
              }
            },
            {
              "x": 20,
              "y": 8,
              "width": 4,
              "height": 4,
              "content": {
                "$ref": "#/spec/panels/0_8"
              }
            },
            {
              "x": 0,
              "y": 12,
              "width": 6,
              "height": 6,
              "content": {
                "$ref": "#/spec/panels/0_9"
              }
            },
            {
              "x": 6,
              "y": 12,
              "width": 6,
              "height": 6,
              "content": {
                "$ref": "#/spec/panels/0_10"
              }
            },
            {
              "x": 12,
              "y": 12,
              "width": 12,
              "height": 6,
              "content": {
                "$ref": "#/spec/panels/0_11"
              }
            }
          ]
        }
      },
      {
        "kind": "Grid",
        "spec": {
          "display": {
            "title": "Query Metrics",
            "collapse": {
              "open": true
            }
          },
          "items": [
            {
              "x": 0,
              "y": 19,
              "width": 12,
              "height": 8,
              "content": {
                "$ref": "#/spec/panels/1_0"
              }
            },
            {
              "x": 12,
              "y": 19,
              "width": 12,
              "height": 8,
              "content": {
                "$ref": "#/spec/panels/1_1"
              }
            }
          ]
        }
      },
      {
        "kind": "Grid",
        "spec": {
          "display": {
            "title": "JVM Metics",
            "collapse": {
              "open": true
            }
          },
          "items": [
            {
              "x": 0,
              "y": 28,
              "width": 12,
              "height": 8,
              "content": {
                "$ref": "#/spec/panels/2_0"
              }
            },
            {
              "x": 12,
              "y": 28,
              "width": 12,
              "height": 8,
              "content": {
                "$ref": "#/spec/panels/2_1"
              }
            },
            {
              "x": 0,
              "y": 36,
              "width": 12,
              "height": 8,
              "content": {
                "$ref": "#/spec/panels/2_2"
              }
            },
            {
              "x": 12,
              "y": 36,
              "width": 12,
              "height": 8,
              "content": {
                "$ref": "#/spec/panels/2_3"
              }
            },
            {
              "x": 0,
              "y": 44,
              "width": 12,
              "height": 8,
              "content": {
                "$ref": "#/spec/panels/2_4"
              }
            },
            {
              "x": 12,
              "y": 44,
              "width": 12,
              "height": 8,
              "content": {
                "$ref": "#/spec/panels/2_5"
              }
            },
            {
              "x": 0,
              "y": 52,
              "width": 12,
              "height": 8,
              "content": {
                "$ref": "#/spec/panels/2_6"
              }
            },
            {
              "x": 12,
              "y": 52,
              "width": 12,
              "height": 8,
              "content": {
                "$ref": "#/spec/panels/2_7"
              }
            },
            {
              "x": 0,
              "y": 60,
              "width": 24,
              "height": 8,
              "content": {
                "$ref": "#/spec/panels/2_8"
              }
            }
          ]
        }
      },
      {
        "kind": "Grid",
        "spec": {
          "display": {
            "title": "Node Metrics",
            "collapse": {
              "open": true
            }
          },
          "items": [
            {
              "x": 0,
              "y": 69,
              "width": 12,
              "height": 8,
              "content": {
                "$ref": "#/spec/panels/3_0"
              }
            },
            {
              "x": 12,
              "y": 69,
              "width": 12,
              "height": 8,
              "content": {
                "$ref": "#/spec/panels/3_1"
              }
            },
            {
              "x": 0,
              "y": 77,
              "width": 12,
              "height": 8,
              "content": {
                "$ref": "#/spec/panels/3_2"
              }
            },
            {
              "x": 12,
              "y": 77,
              "width": 12,
              "height": 8,
              "content": {
                "$ref": "#/spec/panels/3_3"
              }
            },
            {
              "x": 0,
              "y": 85,
              "width": 12,
              "height": 8,
              "content": {
                "$ref": "#/spec/panels/3_4"
              }
            },
            {
              "x": 12,
              "y": 85,
              "width": 12,
              "height": 8,
              "content": {
                "$ref": "#/spec/panels/3_5"
              }
            },
            {
              "x": 0,
              "y": 93,
              "width": 12,
              "height": 8,
              "content": {
                "$ref": "#/spec/panels/3_6"
              }
            },
            {
              "x": 12,
              "y": 93,
              "width": 12,
              "height": 8,
              "content": {
                "$ref": "#/spec/panels/3_7"
              }
            },
            {
              "x": 0,
              "y": 101,
              "width": 12,
              "height": 8,
              "content": {
                "$ref": "#/spec/panels/3_8"
              }
            },
            {
              "x": 12,
              "y": 101,
              "width": 12,
              "height": 8,
              "content": {
                "$ref": "#/spec/panels/3_9"
              }
            },
            {
              "x": 0,
              "y": 109,
              "width": 12,
              "height": 8,
              "content": {
                "$ref": "#/spec/panels/3_10"
              }
            },
            {
              "x": 12,
              "y": 109,
              "width": 12,
              "height": 8,
              "content": {
                "$ref": "#/spec/panels/3_11"
              }
            },
            {
              "x": 0,
              "y": 117,
              "width": 24,
              "height": 8,
              "content": {
                "$ref": "#/spec/panels/3_12"
              }
            }
          ]
        }
      }
    ],
    "duration": "1h"
  }
}